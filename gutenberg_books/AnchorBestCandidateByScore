Anchor Best Candidate (by score) :=
VAR anchor =
    SELECTEDVALUE ( 'BundleSuggestions_Live'[AnchorWorkOrderID] )
VAR base =
    FILTER (
        ALLSELECTED ( 'BundleSuggestions_Live' ),
        'BundleSuggestions_Live'[AnchorWorkOrderID] = anchor
            && 'BundleSuggestions_Live'[DistanceMiles] <= [RadiusMiles Value]
            && DATEDIFF ( TODAY(), 'BundleSuggestions_Live'[CandidateDueDate], DAY ) <= [HighWindowDays Value]
    )
VAR ranked =
    ADDCOLUMNS (
        base,
        "__Score", [BundleScore],
        "__Cost",  [CostSaved ($)]
    )
VAR t =
    TOPN (
        1,
        ranked,
        [__Score], DESC,          -- primary: highest score
        [__Cost],  DESC,          -- tie-breaker: highest savings
        'BundleSuggestions_Live'[DistanceMiles], ASC,  -- then nearest
        'BundleSuggestions_Live'[CandidateWorkOrderID], ASC  -- stable final tie-break
    )
RETURN
IF ( ISBLANK ( anchor ), BLANK (), MAXX ( t, 'BundleSuggestions_Live'[CandidateWorkOrderID] ) )
